Anonifyは以下の性質を満たすように設計されています。


* Auditability：ブロックチェーン上の全ての状態データはプライバシ保護される一方で、許可された監査主体は特定ユーザの状態データが監査可能です。このように暗号化などでデータの秘匿性を保証しつつ、ブロックチェーンの特徴となる状態遷移の履歴を監査できる性質をここではAuditabilityと呼びます。監査主体はブロックチェーン上に記録された暗号文を復号する鍵を所有し、その鍵を用いて復号することで平文の状態データを参照することができます。
* Confidentiality：ハードウェアレベルで隔離保護されるTEEでの状態データの扱いおよびブロックチェーンには暗号化された状態データのみを記録することにより、Anonifyで扱うデータは第三者が不正に閲覧することはできないことが保証されています。つまり、状態データはハードウェアレベルで隔離保護されているTEEにのみ存在し、外部からアクセスすることはできず、またTEE外部の通信経路およびブロックチェーン上ではセキュアな暗号アルゴリズムで暗号化されています。ブロックチェーン上に記録されるデータの暗号化にはTreeKEMを用いたグループ鍵生成メカニズムが用いられ、前方秘匿性および効率的な鍵ローテーションの仕組みを導入しています。これにより万が一特定の暗号文の鍵が漏洩したとしても他の暗号文に対しての影響を最小限にすることが可能となっています。
* General-Purpose State Transition：状態遷移はTEEでの汎用プロセッサにより処理され、秘匿化対象のデータに対する状態遷移ルールはスマートコントラクトにおける処理として柔軟かつハイパフォーマンスに計算を行うことが可能です。また、特定の状態遷移の計算は特定のTEEで閉じて処理されるので、ブロックチェーン上のスマートコントラクトでは非現実的であった計算コストの大きな処理も可能です。
* Blockchain Agnostic：Anonifyはブロックチェーン上のシステムとして、後述するAttested Executionにおける署名検証などの検証ロジックが記述可能なスマートコントラクトが動作可能なことと、外部からノードにトランザクションの書き込み、読み込み可能なクライアント機能を提供していることの2つの性質を満たすあらゆるブロックチェーンに適合することが可能です。
* Fairness：ネットワークに参加するノードおよびTEEは全体アーキテクチャにおける機能として全て公平であり、Anonify上のシステムとして状態遷移および状態データの記録における単一障害点は存在しません。

## セキュリティプロパティ

脅威モデルとして、攻撃者はAnonifyネットワークにおける少なくとも1つのTEEを除く、全てのTEEのOSとネットワークスタックをコントロール可能であると想定します。コントロールされたシステムにおいて、攻撃者は送受信するメッセージのインターセプト、並び替え、遅延を任意に行うことができます。この脅威モデルに対し、Anonifyは以下のセキュリティプロパティを満たすことをゴールとします。

* Correct Execution：確かにネットワーク参加者で合意した状態遷移ルールに沿って処理がされていることをここではCorrect Executionと呼びます。Anonifyでは、TEEのRemote Attestationに基づきCorrect Executionの性質が保証されます。この結果、ブロックチェーン上に記録される暗号化データとTEEに記録される平文データは必ず対応するように記録されます。これは、TEEのRemote attestationを利用しブロックチェーン上で実行プログラムの同一性を検証することと、ブロック（一定のトランザクションのまとまり）ごとのEnclave内状態の一致検証により実現されます。つまり、attestationにより、ネットワークに参加する全てのTEEのEnclave内実行プログラムは同一であり、不正なプログラムを実行できないことを保証します。
* Data Availability：正当なクライアントは状態データにいつでもアクセス可能な性質をここではData Availabilityと呼びます。全ての状態遷移の履歴データは暗号化されブロックチェーンに記録されるので、ブロックチェーン自体のData Availabilityが保証され、かつ復号するための鍵を保有している場合はデータに常にアクセス可能です。TEEの実行環境はData availabilityには寄与せず、TEE内のデータが全て失われてもブロックチェーンの記録から全ての状態データを復元するごとが可能です。つまり、ある特定の参加ノードが何らかの原因で離脱してもシステム全体としては稼働し続け、データも変わらず利用可能です。
* Accountability：万が一、ネットワークに参加している主体が何らかの異常な操作を行なった場合に、その操作がどのTEEにより行われたか検出できる性質をここではAccountabilityと呼びます。Anonifyでは、不正な署名やREPORTの提出などの検証は全てブロックチェーン上で行われ、署名によりどのTEEが実行した操作であるか全ての参加者間で共有されるのでAccountabilityは保証されます。
